/*
 Clusterize.js - v0.17.6 - 2017-03-05
 http://NeXTs.github.com/Clusterize.js/
 Copyright (c) 2015 Denis Lukov; Licensed GPLv3 */
(function(m,n){"undefined"!=typeof module?module.I=n():"function"==typeof define&&"object"==typeof define.H?define(n):this[m]=n()})("Clusterize",function(){function m(a){function b(a,b){b=r(b)?b:[];b.length&&(f="append"==a?f.concat(b):b.concat(f),c.c(f,k))}function d(){clearTimeout(u);u=setTimeout(c.refresh,100)}function e(){w&&(t||(c.content_elem.style.pointerEvents="none"),t=!0,clearTimeout(v),v=setTimeout(function(){c.content_elem.style.pointerEvents="auto";t=!1},50));l!=(l=c.s())&&c.c(f,k);c.options.callbacks.scrollingProgress&&
c.options.callbacks.scrollingProgress(c.getScrollProgress())}if(!(this instanceof m))return new m(a);var c=this,g={rows_in_block:50,blocks_in_cluster:4,tag:null,show_no_data_row:!0,no_data_class:"clusterize-no-data",no_data_text:"No data",keep_parity:!0,callbacks:{}};c.options={};for(var h="rows_in_block blocks_in_cluster show_no_data_row no_data_class no_data_text keep_parity tag callbacks".split(" "),q=0,p;p=h[q];q++)c.options[p]="undefined"!=typeof a[p]&&null!=a[p]?a[p]:g[p];g=["scroll","content"];
for(q=0;h=g[q];q++)if(c[h+"_elem"]=a[h+"Id"]?document.getElementById(a[h+"Id"]):a[h+"Elem"],!c[h+"_elem"])throw Error("Error! Could not find "+h+" element");c.content_elem.hasAttribute("tabindex")||c.content_elem.setAttribute("tabindex",0);var f=r(a.rows)?a.rows:c.D(),k={};a=c.scroll_elem.scrollTop;c.c(f,k);c.scroll_elem.scrollTop=a;var l=!1,v=0,t=!1,u=0;n("scroll",c.scroll_elem,e);n("resize",window,d);c.destroy=function(a){var b=c.scroll_elem;b.removeEventListener?b.removeEventListener("scroll",
e,!1):b.detachEvent("onscroll",e);b=window;b.removeEventListener?b.removeEventListener("resize",d,!1):b.detachEvent("onresize",d);c.i((a?c.m():f).join(""))};c.refresh=function(a){(c.u(f)||a)&&c.update(f)};c.update=function(a){f=r(a)?a:[];a=c.scroll_elem.scrollTop;f.length*c.options.a<a&&(l=c.scroll_elem.scrollTop=0);c.c(f,k);c.scroll_elem.scrollTop=a};c.clear=function(){c.update([])};c.getRowsAmount=function(){return f.length};c.getScrollProgress=function(){return this.options.A/(f.length*this.options.a)*
100||0};c.append=function(a){b("append",a)};c.prepend=function(a){b("prepend",a)};c.getRow=function(a){return f[a]};c.updateRow=function(a,b){f[a]=b};c.walkRows=function(a){for(var b=0,d=f.length;b<d;b++)f[b]=a.call(c,f[b],b)};c.eachRows=function(a){for(var b=0,d=f.length;b<d&&!1!==a.call(c,f[b],b);b++);}}function n(a,b,d){b.addEventListener?b.addEventListener(a,d,!1):b.attachEvent("on"+a,d)}function r(a){return"[object Array]"===Object.prototype.toString.call(a)}function k(a,b){return window.getComputedStyle?
window.getComputedStyle(b)[a]:b.currentStyle[a]}var l=function(){for(var a=3,b=document.createElement("b"),d=b.all||[];b.innerHTML="\x3c!--[if gt IE "+ ++a+"]\x3e\x3ci\x3e\x3c![endif]--\x3e",d[0];);return 4<a?a:document.documentMode}(),w=navigator.platform.toLowerCase().indexOf("mac")+1;m.prototype={constructor:m,D:function(){for(var a=[],b=this.o(this.content_elem);b.length;)a.push(b.shift().outerHTML);return a},C:function(a,b){var d=this.options;d.B=this.content_elem.tagName.toLowerCase();a.length&&
(l&&9>=l&&!d.tag&&(d.tag=a[0].match(/<([^>\s/]*)/)[1].toLowerCase()),1>=this.content_elem.children.length&&(b.data=this.i(a[0]+a[0]+a[0])),d.tag||(d.tag=this.content_elem.children[0].tagName.toLowerCase()),this.u(a))},u:function(a){var b=this.options,d=b.a;b.h=0;if(a.length){a=this.content_elem.children;var e=a[Math.floor(a.length/2)];b.a=e.offsetHeight;"tr"==b.tag&&"collapse"!=k("borderCollapse",this.content_elem)&&(b.a+=parseInt(k("borderSpacing",this.content_elem),10)||0);"tr"!=b.tag&&(a=parseInt(k("marginTop",
e),10)||0,e=parseInt(k("marginBottom",e),10)||0,b.a+=Math.max(a,e));b.l=b.a*b.rows_in_block;b.w=b.blocks_in_cluster*b.rows_in_block;b.h=b.blocks_in_cluster*b.l;return d!=b.a}},s:function(){this.options.A=this.scroll_elem.scrollTop;return Math.floor(this.options.A/(this.options.h-this.options.l))||0},m:function(){var a=this.options;if(!a.tag||!a.show_no_data_row)return[];var b=document.createElement(a.tag),d=document.createTextNode(a.no_data_text);b.className=a.no_data_class;if("tr"==a.tag){var e=
document.createElement("td");e.colSpan=100;e.appendChild(d)}b.appendChild(e||d);return[b.outerHTML]},F:function(a,b){var d=this.options,e=a.length;if(e<d.rows_in_block)return{f:0,b:0,v:0,rows:e?a:this.m()};var c=Math.max((d.w-d.rows_in_block)*b,0);b=c+d.w;var g=Math.max(c*d.a,0);d=Math.max((e-b)*d.a,0);e=[];var h=c;for(1>g&&h++;c<b;c++)a[c]&&e.push(a[c]);return{f:g,b:d,v:h,rows:this.options.callbacks.G?this.options.callbacks.G(e):e}},j:function(a,b){var d=document.createElement(this.options.tag);
d.className=["clusterize-extra-row","clusterize-"+a].join(" ");b&&(d.style.height=b+"px");return d.outerHTML},c:function(a,b){this.options.h||this.C(a,b);a=this.F(a,this.s());var d=a.rows.join(""),e=this.g("data",d,b);this.g("top",a.f,b);b=this.g("bottom",a.b,b);var c=this.options.callbacks,g=[];e?(a.f&&(this.options.keep_parity&&g.push(this.j("keep-parity")),g.push(this.j("top-space",a.f))),g.push(d),a.b&&g.push(this.j("bottom-space",a.b)),c.clusterWillChange&&c.clusterWillChange(),this.i(g.join("")),
"ol"==this.options.B&&this.content_elem.setAttribute("start",a.v),c.clusterChanged&&c.clusterChanged()):b&&(this.content_elem.lastChild.style.height=a.b+"px")},i:function(a){var b=this.content_elem;if(l&&9>=l&&"tr"==this.options.tag){var d=document.createElement("div");for(d.innerHTML="\x3ctable\x3e\x3ctbody\x3e"+a+"\x3c/tbody\x3e\x3c/table\x3e";a=b.lastChild;)b.removeChild(a);for(d=this.o(d.firstChild.firstChild);d.length;)b.appendChild(d.shift())}else b.innerHTML=a},o:function(a){a=a.children;for(var b=
[],d=0,e=a.length;d<e;d++)b.push(a[d]);return b},g:function(a,b,d){var e=b!=d[a];d[a]=b;return e}};return m});
